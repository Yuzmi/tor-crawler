{% extends "base.html.twig" %}

{% block content %}
    <div class="container">
	    <h1 class="text-center">
		    <a href="{{ path('onion_show', {'hash': onion.hash}) }}">
		    	{{ onion.hash }}.onion
		    </a>
	    </h1>

	    <br>

    	<div class="text-center">
			{{ resources.totalItemCount }} URL{{ resources.totalItemCount > 1 ? "s" }}
		</div>

		<br>

		{% if resources.totalItemCount > 0 %}
	    	<div class="text-center">
			    {{ knp_pagination_render(resources) }}
			</div>

			<div class="table-responsive">
				<table class="table table-striped table-bordered table-condensed">
					{% set ths = {
						'r.url': "URL",
						'r.title': "Title",
						'r.dateCreated': "Added",
						'r.dateChecked': "Checked",
						'r.dateLastSeen': "Seen"
					} %}
					<tr>
						{% for key,value in ths %}
							<th>
								{{ knp_pagination_sortable(resources, value, key) }}
								{% if resources.isSorted(key) %}
									{% if resources.direction == "asc" %}
										<i class="fa fa-caret-down"></i>
									{% elseif resources.direction == "desc" %}
										<i class="fa fa-caret-up"></i>
									{% endif %}
								{% endif %}
							</th>
						{% endfor %}
						<th colspan="2"></th>
					</tr>
					{% for r in resources %}
						<tr>
							<td>
								<a href="{{ path("resource_show", {'id': r.id}) }}">
									{{ r.url }}
								</a>
							</td>
							<td>{{ r.title }}</td>
							<td title="{{ r.dateCreated|date('Y-m-d H:i') }}">
								{{ r.dateCreated|date('Y-m-d') }}
							</td>
							<td title="{{ r.dateChecked ? r.dateChecked|date('Y-m-d H:i') }}">
								{{ r.dateChecked ? r.dateChecked|date('Y-m-d') : "Never" }}
							</td>
							<td title="{{ r.dateLastSeen ? r.dateLastSeen|date('Y-m-d H:i') }}">
								{{ r.dateLastSeen ? r.dateLastSeen|date('Y-m-d') : "Never" }}
							</td>
							<td class="text-center">
								<a class="btn btn-default btn-xs" href="{{ r.url }}" title="Direct link" target="_blank" rel="noopener noreferrer">
									<i class="fa fa-link"></i>
								</a>
							</td>
						</tr>
					{% endfor %}
				</table>
			</div>

		    <div class="text-center">
			    {{ knp_pagination_render(resources) }}
			</div>
		{% else %}
			<div class="alert alert-info">
				No URL found for this onion
			</div>
		{% endif %}
	</div>
{% endblock %}
